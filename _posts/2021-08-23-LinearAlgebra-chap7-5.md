---
layout: post
title: "7.5 공분산과 상관계수"
date: 2021-08-23 23:22:28 -0400
categories: [데이터 사이언스 수학]
tags: [확률론]
comments: true
math: true
---

### 표본공분산
- 표본공분산(sample covariance): 자료가 평균값으로부터 얼마나 떨어져 있는지를 나타냄
- $$s_{xy} = {1 \over N} \sum_{i=1}^N (x_i - \bar x)(y_i - \bar y)$$ ($$x_i, y_i$$: i번째의 x 자료와 y자료의 값, $$\bar x \bar y$$: x자료와 y자료의 표본평균)
- 평균값 위치와 표본 위치를 연결하는 사각형의 면적을 사용
- 자료의 위치에 따라 값의 부호가 달라짐
    - ![1](/images/linearalgebra/6_5/1.png){: width="100%" height="100%"}

### 표본상관계수
- 표본상관계수(sample correlation coeifficient): 
- $$r_{xy} = {s_{xy} \over \sqrt{s_x^2 \cdot s_y^2}}$$ (공분산을 각각의 표본표준편차값으로 나누어 정규화) $$\rightarrow$$ 피어슨(Pearson) 상관계수

### 확률변수의 공분산과 상관계수
### 비선형 상관관계
### 앤스콤 데이터
### 다변수 확률변수의 표본공분산
### 다변수 확률변수의 공분산
### 연습문제
- 7.5.1
    - ```python
        from sklearn.datasets import load_iris
    ```

- 기댓값(expectation)
    - 확률변수의 확률밀도함수를 통해 얻은 확률변수의 이론적 평균값 (= 평균)
    - $$E[X]$$ ($$X$$: 확률변수)
    - $$\mu_X$$ or $$\mu$$
- 이산확률변수의 기댓값 = 표본공간의 원소 $$x_i$$의 가중평균
    - $$\mu_X$$ $$= E[X]$$ $$= \sum_{x_i \in \Omega} x_ip(x_i)$$
- e.g. 주사위
    - $$\mu_X = 1 \cdot p(1) + 2 \cdot p(2) + 3 \cdot p(3) + 4 \cdot p(4) + 5 \cdot p(5) + 6 \cdot p(6) = {7 \over 2}$$

### 확률변수의 변환
- 기존의 확률변수를 사용하여 새로운 확률변수를 만드는 것
- $$Y = f(X)$$
- 여러 확률변수가 있을 때도 성립 ($$Z = X + Y$$)

### 기댓값의 성질
- $$E[c] = c$$ ($$c$$: 확률변수가 아닌 상수)
- $$E[cX] = cE[X]$$
- $$E[X+Y]$$ $$= E[X]$$ $$+ E[Y]$$
- $$E[c_1X + c_2Y]$$ $$= c_1E[X]$$ $$+ c_2E[Y]$$

### 통계량(statistics)
- 확률변수 X로부터 데이터 집합 {$$x_1, x_2, \cdots, x_N$$}을 얻었을 때, 데이터 집합의 모든 값을 정해진 공식에 넣어서 하나의 숫자로 구한 것
- ex) 표본의 합, 표본평균, 표본중앙값, 표본분산 등
- 통계량도 확률변수의 변환에 포함

### 표본평균 확률변수
- 확률변수로부터 N개의 표본을 만들어 구한 집합의 평균 값
- $$\bar X$$
- $$\bar X = {1 \over N} \sum_{i=1}^N X_i$$
    - $$X_i$$: i번째로 실현된 표본값을 생성하는 확률변수, 원래 확률변수 X의 복사본 

### 기댓값과 표본평균의 관계
- $$E[\bar X] = E[X]$$<br/>
(증명)<br/>
$$E[\bar X] = E[{1 \over N} \sum_{i=1}^N X_i] = {1 \over N} \sum_{i=1}^NE[X_i]$$<br/>
$$= {1 \over N} \sum_{i=1}^N$$ $$E[X]$$ $$= {1 \over N} N$$ $$E[X]$$ $$= E[X]$$<br/>
$$\rightarrow$$ 표본평균은 확률변수의 기댓값 근처의 값이 된다

### 중앙값
- 확률변수의 중앙값(median): 중앙값보다 큰 값이 나올 확률과 작은 값이 나올 확률이 0.5로 같은 값
- $$F(x)$$: 누적확률분포, $$0.5 = F($$ 중앙값 $$)$$ $$\leftrightarrow$$ 중앙값 = $$F^{-1}(0.5)$$

### 최빈값
- 이산확률분포에서는 가장 확률 값이 큰 수
- 연속확률분포에서는 확률밀도함수 $$p(x)$$의 값이 가장 큰 확률변수의 값 (= 확률밀도함수의 최댓값)
- 최빈값 = $$\arg \max_x p(x)$$

### 연습문제
- 7.2.1
    - $$E[X]$$ $$= 1 \cdot p(1) + 0 \cdot p(0) = {1 \over 2}$$ 
- 7.2.2
- 7.2.3
- 7.2.4
- 7.2.5
- 7.2.6

<br/>
<br/>
이 글은 ['데이터 사이언스 스쿨 수학편'](https://datascienceschool.net/02%20mathematics/00.00%20소개의%20글.html)을 정리한 것입니다.
질문이나 오류가 있다면 댓글 남겨주세요.